\documentclass{article}
%
%\usepackage{pdfsync}           % Used in Mac OSX
\usepackage[mathcal,mathbf]{euler}
\usepackage{theorem,amsmath,enumerate,fancyhdr,amssymb,amsfonts}
\usepackage{graphicx}           %Used in Mac OSX
%\usepackage[pdftex]{graphics}  %Might be needed in non Mac OSX systems
\usepackage{myDefs}
\usepackage{url}
%In order to be consistent use the following notation in your notes:
\graphicspath{{./fig/}}
\title{
Tissue tree specific gene biclustering
}
\author{Avinash Das, Fabian M\"uller, Peter Ebert}

\date{\today}
\begin{document}

\pagestyle{fancy}
\lhead{{\bf Tissue tree specific biclustering}{ }
\\{\bf } } 
\rhead{{\bf Date: }\today}

\maketitle
\section{Background}

\cite{Kaski2010} gave a probabilistic generative model framework to find hierarchical organized biclusters in gene expression 
matrices (Gene x condition). The hierarchical biclustering method can be seen as a special instance of biclustering. 
The biclusters near the roots are coarse group of condition tied by a small subset of genes
with homogeneous expression across the group wheres nodes deeper in the tree correspond to samller sets of conditions that exhibit homogeneous expression levels in a large subset of genes.

As other generative modeling, they start by presenting a generative process to 
observe a gene expression matrix. The generative process first samples the tree hierarchy 
of conditions (i.e. the condition are partitioned into tree structure), next 
it positions the genes into the sampled tree structure and finally it samples expression of genes
for each condition (which are observed variables). 

\par \textbf{Sampling of tree structure}:
In order to partition the condition, they used the Chinese restaurant process (CRP). The root of the tree
is initialized with all the conditions in the data and are partitioned using CRP. Each of these groups are 
recursively partitioned till maximum tree height is reached. 

\par \textbf{Length assignment to edges}:
Next, they used feature activation model to find active genes at each node, defined by latent variable $z_{j,u}$ for
gene $j$ and node $u$.
The length $l_{uv}$ of each edge $(u,v)$ is sampled with $ \sim \text{Beta}(\alpha,\beta)$. 
The $z_{j,u}$ 
is then sampled with probability of gene to be active equal to $l_{uv}$ (i.e. $P(z_{j,u} = 1) = l_{uv}$). 
Further, once a gene is activated at a node, it remains active in all its descendants.  


\par \textbf{Generation of gene expression}
Given the gene states at each node of the tree, the gene expression $Y$ is generated using:
\begin{eqnarray}
	Y_{ju}|z_{ju}=1  &\sim& N(\mu_{ju}, \sigma^2) \nonumber\\
	Y_{ju}|z_{ju}=0  &\sim& N(\mu_{0}=1, \sigma_0^2=1) 
	\label{eqn:Kexp}
\end{eqnarray}

The generative process is shown in the fig. ~\ref{fig:Kgen}.

\begin{figure}[ht]
	\begin{center}
		\includegraphics[scale=0.5]{Kgen.jpg}
	\end{center}
	\caption{Illustration of the generative process for a fictitious noise-free data set with three genes (A, B, and C) and four samples (“healthy 1,” “healthy 2,” “leukemia,” and “melanoma”). The healthy samples share the same path assignment, while each of the cancer samples has its own unique path. The rounded rectangles represent nodes and indicate the current feature activation state. Gene A becomes active at both of the root's child nodes, leading to homogeneous expression for the healthy samples as well as for the cancer samples, although the between-group difference in expression is significant. Gene C exhibits homogeneous expression under both cancer samples, but not under the healthy samples. Gene B has a specific expression pattern for each of the samples (fig taken from \cite{Kaski2010}).}
	\label{fig:Kgen}
\end{figure}<++>
Next, they define joint distribution over the random variables and perform inferencing using the Gibbs
sampling.

\par We make the following modification to the presented hierarchical biclustering method in order to adapt for the given genes $\times$ tissue expression matrix. Observations:
\begin{itemize}
	\item We already have a tissue hierarchy.
	\item Our expression data are discrete values ( no expression, weak expression, medium expression and
		high expression).
	\item In our tissue tree internal nodes have observation.
	\item We want, in addition to find gene clusters, to categorize genes based on its expression pattern 
		across tissue.
\end{itemize}
\section{Method}
Taking cues from the generative method defined in \cite{Kaski2010}, we can define a generative process in context of our problem. We will start with the tissue tree $T(V,E)$ which can be constructed by assigning to each node, all leaf-tissues that are included by the subtree induced by that node. We will determine the activation states of genes at each tree node. Finally, given the state of gene we will sample its observed expression level
%We will define set of the genes $G$ as features at the nodes of the tissue tree. 
\par \textbf{Latent variable $Z$}:
We define latent state variable $Z= \{z_{ju} \in\{0,1,2\} : \forall j \in G, u \in V\}$ corresponding to each gene at each node with following definition:
\begin{eqnarray}
	z_{ju} &=& 0 \implies \textit{gene $j$ is homogenously inactive in subtree with $u$ as root.} \nonumber\\ 
	z_{ju} &=& 1 \implies \textit{gene $j$ is homogenously active with high expression in subtree with  $u$ as root.} \nonumber \\
	z_{ju} &=& 2 \implies \textit{gene $j$ have inhomogenously activity in subtree with $u$ as root.} \nonumber 
\end{eqnarray}
In addition, once a node $z_{ju}$ takes a value either 0 or 1 corresponding to states homogeneously active or in-active all its children 
node in subtree stays in same homogeneous state. $Z$ can be then sampled from multinomial distribution with a Dirichlet prior.
\begin{eqnarray}
	z &\sim& \text{mult}(\phi) \nonumber \\
	\phi &\sim&  \text{Dir}(\alpha,\beta,\gamma) \nonumber
	\label{eqn:zdist}
\end{eqnarray}



\par \textbf{Generation of expression level}: Lets assume we have binary data for expression level i.e. only 2 state 
expressed or not expressed. Given the state of the genes at the nodes of the tissue tree,  we can generate samples of expression
level using a binomial distribution. 
\begin{eqnarray}
	Y|Z = i &\sim& \text{Bin}(p_i) \nonumber \\
	p_i &\sim&  \text{Beta}(\alpha_i,  \beta_i) \forall i \in \{1,2,3\}  
	\label{eqn:ydist}
\end{eqnarray}
The beta priors can be chosen so to reflect our expected behaviour of expression level in different gene state. One example of prior that can be taken
is shown in fig. \ref{fig:betaP}.
\begin{figure}[ht]
	\begin{center}
		\includegraphics[scale=0.5]{beta.jpg}
	\end{center}
	\caption{Beta priors for homogeneous active, homogeneous inactive and inhomogeneous gene state. The priors are consistent
	with the interaction matrix data; e.g. $E(p_2)$ = average that any gene is expressed in interaction matrix.}
	\label{fig:betaP}
\end{figure}


We can extend the method for the discrete values of expression level by using multinomial distribution instead of binomial distribution in order to represent the different expression stages (weak, intermediate, high and no expression). 
\subsection{Inference}
TBD.
\section{Expected outcomes}
\begin{itemize}
	\item Tissue specific gene active and inactive gene bicluster: We will get state of gene $Z$ for each tissue subtree, that can be used to 
		get information like gene clusters with tissue specific activity. We will also get information whether a 
		gene cluster is active or inactive homogeneously at that node.
	\item We can  quickly identify gene which are only expressed only at a node (or small subtree) and are not expressed in rest of the
		tree. 
	\item We can quantify distance between different node of tissue tree in term of gene activity and expression level i.e we will get a distance between different tissues. 
	\item We will obtain a noise resistant model because we are modelling the output observation as distribution.
	\item the method will be computationally less demanding as the CRP does not have to be sampled.
\end{itemize}

\bibliographystyle{apalike}	% (uses file "plain.bst")
\bibliography{diary}		% expects file "myrefs.bib"
\end{document}  
